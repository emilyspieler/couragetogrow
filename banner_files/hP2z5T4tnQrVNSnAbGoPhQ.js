(function() {var m="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this,n={};function p(a,b){(n[a]=n[a]||[]).push(b);var c=m;a=a.split(".");for(var d=0;d<a.length-1&&c;d++)c=c[a[d]];a=a[a.length-1];c&&c[a]instanceof Function&&(c[a]=b(c[a]))}
function q(){q=function(){};if(!m.Symbol){m.Symbol=r;var a=[],b=function(b){return function(d){a=[];d=b(d);for(var e=[],f=0,k=d.length;f<k;f++){var g;a:if(g=d[f],14>g.length)g=!1;else{for(var l=0;14>l;l++)if(g[l]!="jscomp_symbol_"[l]){g=!1;break a}g=!0}g?a.push(d[f]):e.push(d[f])}return e}};p("Object.keys",b);p("Object.getOwnPropertyNames",b);p("Object.getOwnPropertySymbols",function(c){return function(d){b.da=Object.getOwnPropertyNames(d);a.push.apply(c(d));return a}})}}var t=0;
function r(a){return"jscomp_symbol_"+a+t++}function v(){q();m.Symbol.iterator||(m.Symbol.iterator=m.Symbol("iterator"));v=function(){}}function w(a){v();q();v();var b=a[Symbol.iterator];if(b)return b.call(a);var c=0;return{next:function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}}}
function x(a,b){v();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}var y="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function z(a,b){if(b){for(var c=m,d=a.split("."),e=0;e<d.length-1;e++){var f=d[e];f in c||(c[f]={});c=c[f]}d=d[d.length-1];e=c[d];b=b(e);if(b!=e){a=n[a]||[];for(e=0;e<a.length;e++)b=a[e](b);y(c,d,{configurable:!0,writable:!0,value:b})}}}z("Array.prototype.keys",function(a){return a?a:function(){return x(this,function(a){return a})}});function A(a,b){return Object.prototype.hasOwnProperty.call(a,b)}
z("WeakMap",function(a){function b(a){this.u=(g+=Math.random()+1).toString();if(a){q();v();a=w(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}}function c(a){if(!A(a,f)){var b={};b[f]=k;y(a,f,{value:b})}}function d(a){return function(b){var g=a(b);if(A(b,f)&&A(b[f],f)&&b[f][f]===k)for(b=0;b<g.length;b++)if(g[b]==f){g.splice(b,1);break}return g}}function e(a){return function(b){c(b);return a(b)}}if(function(){if(!a||!Object.seal)return!1;var b=Object.seal({}),g=Object.seal({}),c=new a([[b,
2],[g,3]]);if(2!=c.get(b)||3!=c.get(g))return!1;c.delete(b);c.set(g,4);return!c.has(b)&&4==c.get(g)}())return a;var f="$jscomp_hidden_"+Math.random().toString().substring(2),k={};p("Object.getOwnPropertyNames",d);p("Object.keys",d);p("Reflect.enumerate",d);p("Reflect.ownKeys",d);p("Object.freeze",e);p("Object.preventExtensions",e);p("Object.seal",e);var g=0;b.prototype.set=function(a,b){c(a);if(!A(a,f))throw Error("WeakMap key fail: "+a);a[f][this.u]=b;return this};b.prototype.get=function(a){return A(a,
f)?a[f][this.u]:void 0};b.prototype.has=function(a){return A(a,f)&&A(a[f],this.u)};b.prototype.delete=function(a){return A(a,f)&&A(a[f],this.u)?delete a[f][this.u]:!1};return b});
z("Map",function(a){function b(){var a={};return a.previous=a.next=a.head=a}function c(a,b){var c=a.i,d={next:function(){if(c){for(;c.head!=a.i;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}}};d[Symbol.iterator]=function(){return d};return d}function d(a,b){var c;c=b&&typeof b;"object"==c||"function"==c?f.has(b)?c=f.get(b):(c=""+ ++k,f.set(b,c)):c="p_"+b;var d=a.o[c];if(d&&A(a.o,c))for(a=0;a<d.length;a++){var e=d[a];if(b!==b&&e.key!==e.key||
b===e.key)return{id:c,list:d,index:a,g:e}}return{id:c,list:d,index:-1,g:void 0}}function e(a){this.o={};this.i=b();this.size=0;if(a){a=w(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}}if(function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a(w([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();
return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(f){return!1}}())return a;q();v();var f=new WeakMap;e.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.o[c.id]=[]);c.g?c.g.value=b:(c.g={next:this.i,previous:this.i.previous,head:this.i,key:a,value:b},c.list.push(c.g),this.i.previous.next=c.g,this.i.previous=c.g,this.size++);return this};e.prototype.delete=function(a){a=d(this,a);return a.g&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.o[a.id],
a.g.previous.next=a.g.next,a.g.next.previous=a.g.previous,a.g.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.o={};this.i=this.i.previous=b();this.size=0};e.prototype.has=function(a){return!!d(this,a).g};e.prototype.get=function(a){return(a=d(this,a).g)&&a.value};e.prototype.entries=function(){return c(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return c(this,function(a){return a.key})};e.prototype.values=function(){return c(this,function(a){return a.value})};
e.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var k=0;return e});function B(a,b){this.G=a;this.namespace=void 0===b?null:b}B.prototype.setItem=function(a,b){try{return this.G.setItem(null==this.namespace?a:this.namespace+"."+a,b),!0}catch(c){return!1}};B.prototype.getItem=function(a){return this.G.getItem(null==this.namespace?a:this.namespace+"."+a)};
B.prototype.removeItem=function(a){this.G.removeItem(null==this.namespace?a:this.namespace+"."+a)};function C(){this.xhr=null}C.prototype.cancel=function(){this.xhr&&(this.xhr.abort(),this.xhr=null)};C.prototype.finish=function(){this.xhr=null};function D(a){this.J=a&&a.analyticsContext||null;this.D=a&&a.authToken||null;this.F=a&&a.authzToken||null;this.K=a&&a.brandRestriction||null;this.N=a&&a.buildName||null;this.O=a&&a.buildSha||null;this.l=a&&a.csrfTokens||{};this.H=a&&a.serverRoot||null;this.ba=!!this.H;this.ca=this.H?this.H+"/_ajax":"/_ajax"}
function E(a){var b=a.indexOf("/",1);return-1==b?a:a.substring(0,b)}D.prototype.get=function(a,b){var c=new C;this.send("GET",a,null,!0,null,c,b);return c};D.prototype.post=function(a,b,c){var d=new C;G(this,"POST",a,b,!0,0,d,c);return d};
function G(a,b,c,d,e,f,k,g){var l=E(c);if(l in a.l){var h=a.l[l];a.send(b,c,d,e,h,k,function(u,F){418==u&&1>f?(a.l[l]==h&&delete a.l[l],G(a,b,c,d,e,f+1,k,g)):(g&&g(u,F),k.finish())})}else a.send("GET","/csrf"+l,null,e,null,k,function(h,F){200==h?(l in a.l||(a.l[l]=String(F)),G(a,b,c,d,e,f,k,g)):(g(h,null),k.finish())})}
D.prototype.send=function(a,b,c,d,e,f,k){function g(){4==h.readyState&&l()}function l(){var a,b,c;try{a=h.status;var d,e;try{d=h.getResponseHeader("X-Canva-Auth")}catch(g){}try{e=h.getResponseHeader("X-Canva-Authz")}catch(g){}d&&(u.D="!"!=d?d:null);e&&(u.F="!"!=e?e:null);b=h.responseText}catch(g){if(g.message&&g.message.match(/c00c023f/))a=0,b="";else throw f.finish(),g;}b=b&&b.trim?b.trim():"";d=b.substring(0,20);if(0<d.length){if("'\"])}while(1);\x3c/x\x3e//"!=d){k(500,null);f.finish();return}b=
b.substring(20);try{c=JSON.parse(b)}catch(g){k(500,null);f.finish();return}}else c=null;k(a,c);f.finish()}b=this.ca+b;var h=f.xhr=new XMLHttpRequest,u=this;h.open(a,b,d);this.ba&&(h.withCredentials=!0);"GET"!=a&&e&&h.setRequestHeader("X-Csrf-Token",e);this.J&&h.setRequestHeader("X-Canva-Analytics",this.J);this.D&&h.setRequestHeader("X-Canva-Auth",this.D);this.F&&h.setRequestHeader("X-Canva-Authz",this.F);this.K&&h.setRequestHeader("X-Canva-Brand",this.K);this.N&&h.setRequestHeader("X-Canva-Build-Name",
this.N);this.O&&h.setRequestHeader("X-Canva-Build-Sha",this.O);null===c||void 0===c?a=null:(h.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8"),a=JSON.stringify(c));d?(h.onreadystatechange=g,h.send(a)):(h.send(a),l())};function H(a){this.type=a}H.prototype.required=function(a,b){b=b[a];if(null==b||typeof b!=this.type)throw new TypeError("expected "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};H.prototype.optional=function(a,b){b=b[a];if(null!=b&&typeof b!=this.type)throw new TypeError("expected optional "+this.type+' for property "'+a+'", found: '+JSON.stringify(b));return b};var I=new H("string"),J=new H("number"),K=new H("object");function L(a){this.message=a.message;this.Y=a.Y;this.X=a.X}function M(a){var b;b=I.required("A",a);return new L({message:b,Y:J.optional("B",a),X:J.optional("C",a)})}function N(a){this.C=a.C||[]};function O(){this.view=null}O.prototype.v=function(a){var b=this;this.view&&(this.view.remove(),this.view=null);a&&(this.view=new Q,this.view.render(a).$el.appendTo("body"),this.view.once("hide",function(){return b.trigger("hide")}))};O.prototype.on=Backbone.Events.on;O.prototype.off=Backbone.Events.off;O.prototype.trigger=Backbone.Events.trigger;function Q(){}Q=Backbone.View.extend({className:"systemAlert"});Q.prototype.events=function(){return{"click .systemAlertHide":this.hide}};
Q.prototype.hide=function(a){a.preventDefault();this.trigger("hide")};Q.prototype.render=function(a){var b=this.el;soy.asserts.assertType(goog.isString(a)||a instanceof goog.soy.data.SanitizedContent,"message",a,"string|goog.soy.data.SanitizedContent");a=soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cp class\x3d"systemAlertMessage"\x3e'+soy.$$escapeHtml(a)+'\x3c/p\x3e\x3ca class\x3d"systemAlertHide" href\x3d"#"\x3eOK, hide\x3c/a\x3e');b.innerHTML=a;return this};function R(){}R.prototype.now=function(){return Date.now()};var S=new R;var U=new T;function T(){}T.prototype.setInterval=function(a,b){return window.setInterval(a,b)};T.prototype.clearInterval=function(a){window.clearInterval(a)};T.prototype.setTimeout=function(a,b){return window.setTimeout(a,b)};T.prototype.clearTimeout=function(a){window.clearTimeout(a)};T.prototype.requestAnimationFrame=function(a){return window.requestAnimationFrame(a)};T.prototype.cancelAnimationFrame=function(a){window.cancelAnimationFrame(a)};function V(a,b,c,d,e){var f=this;this.view=a;this.j=this.message=null;this.R=c;this.aa=b;this.Z=d;this.W=e;this.w=null;this.view.on("hide",function(){if(f.message){var a=f.R,b="acknowledged."+f.message,c=f.W.now();try{var d=JSON.stringify(c);a.setItem(b,d)}catch(e){}f.v(null)}})}
function W(a){a.j&&a.j.cancel();a.j=a.aa.get("/alerts?active",function(b,c){a.j=null;if(200===b){if(null==c||"object"!=typeof c)throw new TypeError("expected an object, found: "+c);b=c.A;if(null!=b)if(Array.isArray(b))for(c=0;c<b.length;c++)K.required(String(c),b);else throw new TypeError("expected repeated "+K.type+' for property "A", found: '+JSON.stringify(b));b=b?b.map(M):b;b=(new N({C:b})).C;a.v(b.length?b[0].message:null)}})}
V.prototype.start=function(a){var b=this;null==this.w&&(this.v(void 0!==a?a:null),this.w=this.Z.setInterval(function(){return W(b)},18E5))};V.prototype.stop=function(){null!=this.j&&(this.j.cancel(),this.j=null);null!=this.w&&this.Z.clearInterval(this.w)};V.prototype.v=function(a){if(a){var b;try{var c=this.R.getItem("acknowledged."+a);b=null!==c?JSON.parse(c):null}catch(d){b=null}if(null!=b&&864E5>this.W.now()-b)return}this.message=a;this.view.v(a)};$(function(){var a;if(window.localStorage)a=new B(window.localStorage,"SystemAlertController");else throw Error("ClientStore: localStorage is not defined on window, likely an unsupported browser");(new V(new O,new D(window.httpServiceConfig),a,U,S)).start(window.systemAlert)});})();
